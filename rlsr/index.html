<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Robust Layerwise Scaling Rules</title>
  <link rel="stylesheet" href="../css/bootstrap.min.css">
  <script id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
  </script>
  <style>
    body {
      background-image: url("../images/bg-subject.jpg");
      background-repeat: repeat;
      background-attachment: fixed;
      background-size: 100%;
    }

    .project_name {
      top: 80px;
      font-size: 35px;
      text-align: center;
      color: #eb5424;
      font-family: 'FontAwesome';
      font-weight: bold;
    }

    .project_detail {
      top: 80px;
      font-size: 100px;
    }

    .subvideo {
      border-radius: 0px;
      vertical-align: middle;
      position: relative;
      text-decoration: none;
      font-size: 35px;
      font-weight: 600;
      color: white;
      width: 66%;
      text-align: left;
      font-family: "等线";
      min-height: 36%;
      max-height: 36%;
      background-color: rgba(0, 0, 0, 0.25);
      display: inline-block;
      -webkit-box-shadow: 0px 0px 0px 1px rgba(255, 255, 255, 0.4)inset;
      -moz-box-shadow: 0px 0px 0px 1px rgba(255, 255, 255, 0.4)inset;
      margin: 0 6px 0px 0;
      overflow: hidden;
      line-height: 40px;
    }

    .subvideo:hover {
      margin-top: -3px;
      margin-right: 3px;
      margin-bottom: -3px;
      margin-left: -3px;
      border: 3px solid #000;
    }

    .project_photo {
      top: -0.6%;
      text-align: center;
      padding-top: 0%;
      padding-bottom: 0px;
      border-radius: 20px;
    }

    .describe {
      width: 66%;
      height: 12%;
      margin: auto;
    }

    .describe_detail {
      position: center;
      color: black;
      font-size: 20px;
      text-align: left;
      word-break: normal | break-all | keep-all;
      font-family: 'FontAwesome'
    }

    .github {
      position: fixed;
      top: 17%;
      right: 10%;
      width: 50px;
      height: width;
      border-radius: 100%;
    }

    .github:hover {
      src: url("images/software.png");
    }

    .software {
      position: fixed;
      top: 24.3%;
      right: 10%;
      width: 50px;
      height: 50px;
      border-radius: 100%;
    }

    .back {
      position: fixed;
      top: 0%;
      left: 0%;
      width: 50px;
      height: 50px;
      border-radius: 100%;
    }

    .last_arrow {}

    .next_arrow {}

    .last_img {
      position: fixed;
      top: 42.5%;
      left: 2.5%;
      width: 12%;
      height: width;
      border-radius: 8px;
    }

    .last_img:hover {
      margin-top: -3px;
      margin-right: -3px;
      margin-bottom: -3px;
      margin-left: -3px;
      border: 3px solid #000;
    }

    .next_img {
      position: fixed;
      top: 42.5%;
      right: 2.5%;
      width: 12%;
      height: width;
      border-radius: 8px;
    }

    .next_img:hover {
      margin-top: -3px;
      margin-right: -3px;
      margin-bottom: -3px;
      margin-left: -3px;
      border: 3px solid #000;
    }

    .up {
      position: fixed;
      top: 18.2%;
      left: 7%;
      width: 3%;
      height: 50px;
      border-radius: 100%;
    }

    .up:hover {
      top: 17.2%;
      margin-top: -3px;
      margin-right: -3px;
      margin-bottom: -3px;
      margin-left: -3px;
      border: 3px solid #000;
    }

    .down {
      position: fixed;
      top: 71.6%;
      left: 7%;
      width: 3%;
      height: 50px;
      border-radius: 100%;
    }

    .down:hover {
      top: 72.6%;
      margin-top: -3px;
      margin-right: -3px;
      margin-bottom: -3px;
      margin-left: -3px;
      border: 3px solid #000;
    }

    .navbar-default {
      border: none;
      -webkit-box-shadow: 0 2px 8px 0 rgba(50, 50, 50, 0.08);
      box-shadow: 0 2px 8px 0 rgba(50, 50, 50, 0.08);
      margin: 0;
      padding: 0;
    }

    .navbar-default .navbar-brand {
      color: #212227;
      font-weight: bold;
      font-size: 20px;
      line-height: 45px;
      padding: 5px 0 0 12px;
      font-family: 'FontAwesome';
    }

    .navbar-default .navbar-nav li a {
      color: #202020;
      font-size: 15px;
      font-weight: bold;
      line-height: 20px;
      letter-spacing: 1px;
      font-family: 'FontAwesome';
    }

    .navbar-default .navbar-nav li a:hover {
      color: #eb5424;
    }

    .navbar-default .navbar-nav>li>a:hover,
    .navbar-default .navbar-nav>li>a:focus {
      color: #eb5424;
      background-color: transparent;
    }

    .navbar-default .navbar-nav>.active>a,
    .navbar-default .navbar-nav>.active>a:hover,
    .navbar-default .navbar-nav>.active>a:focus {
      color: #eb5424;
      background-color: transparent;
    }

    .navbar-default .navbar-toggle {
      border: none;
      padding-top: 10px;
    }

    .navbar-default .navbar-toggle .icon-bar {
      background: #eb5424;
      border-color: transparent;
    }

    .navbar-default .navbar-toggle:hover,
    .navbar-default .navbar-toggle:focus {
      background-color: transparent
    }
  </style>
  
</head>

<body>
  <div class="navbar navbar-default bs-dos-nav navbar-fixed-top sticky-navigation" role="navigation">
    <div class="container">

      <div class="navbar-header">
        <button class="navbar-toggle" data-toggle="collapse" data-target="#rock-navigation">
          <span class="icon icon-bar"></span>
          <span class="icon icon-bar"></span>
          <span class="icon icon-bar"></span>
        </button>
        <a href="https://lauyikfung.github.io" class="navbar-brand">Lewis Yik-fung Lau</a>
      </div>
      <nav class="collapse navbar-collapse" id="rock-navigation">
        <ul class="nav navbar-nav navbar-right main-navigation text-uppercase">
          <li><a href="https://lauyikfung.github.io/RPG" class="smoothScroll">Next Project</a></li>
          <li><a href="https://arxiv.org/abs/2510.15262" class="smoothScroll">Paper</a></li>
          <li><a href="https://arxiv.org/pdf/2510.15262" class="smoothScroll">PDF</a></li>
        </ul>
      </nav>

    </div>
  </div>
  <div class="project_name">
    <p class="name_detail">Robust Layerwise Scaling Rules by Proper Weight Decay Tuning</p>
  </div>
  <div class="project_name">
    <p class="name_detail">Robust Layerwise Scaling Rules by Proper Weight Decay Tuning</p>
  </div>
  <div class="project_photo">
    <img src="../images/rlsr.png" class="subvideo project_photo"></img>
  </div>
  <div class="describe">
    <p class="describe_detail" align="center">
      经验缩放定律规定了如何分配参数、数据和计算，而最大更新参数化（μP）通过均衡早期更新幅度实现跨宽度的学习率迁移。
      然而，在现代尺度不变架构中，训练很快进入由优化器控制的稳定状态，其中归一化层会产生向后的尺度敏感性，有效学习率变得依赖于宽度，从而降低 μP 迁移率。
      我们通过为 AdamW 引入权重衰减缩放规则来解决这个问题，该规则可以保持跨宽度的子层增益。根据经验，每个矩阵参数的奇异值谱在范数中按 \(\sqrt{\eta/\lambda}\) 缩放，形状近似不变；在宽度缩放 \(d\) 下，我们观察到顶部奇异值按\(\sqrt{\eta/\lambda}\cdot d^{0.75}\)缩放。
      将此观察结果与矩阵类参数的 μP 学习率规则 \(\eta_2 \propto d^{-1}\) 相结合，意味着经验权重衰减缩放规则 \(\lambda_2 \propto \sqrt{d}\) ，该规则近似保持子层增益宽度不变。结合在 \(\eta_1=\Theta_d(1)\) 和 \(\lambda_1=0\) 处训练的类向量参数，这实现了学习率和权重衰减从代理宽度到目标宽度的<b>零样本</b>迁移，消除了每个宽度的扫描。
      我们在 LLaMA 风格的 Transformer 上以及最小合成设置中验证了该规则，并提供了一种简单的诊断方法，即匹配顶部奇异值，以检查子层增益不变性。我们的结果通过明确控制优化器设置的稳态尺度，将 μP 扩展到接近初始状态之外，为 AdamW 下的宽度稳健超参数迁移提供了一种实用方法。<br>
    </p>
    <p class="describe_detail">
      Empirical scaling laws prescribe how to allocate parameters, data, and compute, while maximal-update parameterization (μP) enables learning-rate transfer across widths by equalizing early-time update magnitudes. 
      However, in modern scale-invariant architectures, training quickly enters an optimizer-governed steady state where normalization layers create backward scale sensitivity and the effective learning rate becomes width dependent, degrading μP transfer. 
      We address this by introducing a weight-decay scaling rule for AdamW that preserves sublayer gain across widths. Empirically, the singular-value spectrum of each matrix parameter scales in norm as \(\sqrt{\eta/\lambda}\) with an approximately invariant shape; under width scaling \(d\), we observe that the top singular value scales approximately as \(\sqrt{\eta/\lambda}\cdot d^{0.75}\). 
      Combining this observation with the μP learning-rate rule \(\eta_2 \propto d^{-1}\) for matrix-like parameters implies an empirical weight-decay scaling rule \(\lambda_2 \propto \sqrt{d}\) that approximately keeps sublayer gains width invariant. 
      Together with vector-like parameters trained at \(\eta_1=\Theta_d(1)\) and \(\lambda_1=0\), this yields <b>zero-shot</b> transfer of both learning rate and weight decay from proxy to target widths, removing per-width sweeps. 
      We validate the rule on LLaMA-style Transformers and in a minimal synthetic setting, and we provide a simple diagnostic, matching top singular values, to check sublayer-gain invariance. 
      Our results extend μP beyond the near-init regime by explicitly controlling steady-state scales set by the optimizer, offering a practical recipe for width-robust hyperparameter transfer under AdamW.<br>
    </p>
    
  </div>
  <a href="https://lauyikfung.github.io/kimi">
    <img src="../images/kimi1-5.png" class="next_img"></img></a>
</body>

</html>